{{ define "main" }}
  <header class="gallery-info">
    {{ $currentPage := . }}
    {{ $resources := .Resources }}
    {{ range ($resources.Match "logo.svg") }}
      {{ .Content | safeHTML }}
    {{ end }}
    <h3>{{ .Params.venue }} &mdash; {{ .Params.city }}</h3>
    <section class="gallery-info__credits">
      <span>Directed by {{ .Params.director }}</span>
      <span>Featuring Thomas as {{ .Params.role }}</span>
    </section>
    <p class="small">Photos by {{ .Params.photos_by }}</p>
    <ul class="gallery">
      {{ range .Params.order }}
        {{ $class := newScratch }}
        {{ if isset . "major" }}
          {{ $class.Set "class" "gallery__item major" }}
        {{ else }}
          {{ $class.Set "class" "gallery__item" }}
        {{ end }}
        {{ $media := . }}
        {{ $images := $resources.Match .file }}
        {{ range $images }}
          <li class="{{ $class.Get "class" }}">
            <a href="{{ (.Resize "1200x").Permalink }}" data-caption="{{ $media.caption }}">
              {{ if in ($class.Get "class") "major" }}
              {{ $thumb := (.Resize "800x") }}
              <img src="{{ (.Resize "800x").Permalink }}">
              {{ else }}
              <img src="{{ (.Resize "400x").Permalink }}">
              {{ end }}
            </a>
          </li>
        {{ end }}
      {{ end }}
    </ul>
  {{ .Content }}
{{ end }}
